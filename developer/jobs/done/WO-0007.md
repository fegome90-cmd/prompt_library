# WO-0007: Agregar √≠ndices a schema Prisma

## Metadatos
| Campo | Valor |
|-------|-------|
| id | WO-0007 |
| title | Agregar √≠ndices a schema Prisma |
| type | perf |
| priority | P2 |
| area | DB |
| status | üî¥ Pending |

## Rationale
Hallazgo MED: Sin √≠ndices definidos. Campos category, status, authorId sin √≠ndice causan queries lentas con muchos prompts.

## Scope

### Include
- `prisma/schema.prisma`

### Exclude
- No modificar modelos existentes
- No agregar nuevos campos

## Dependencies
Ninguna

## Acceptance Criteria
- [ ] Schema tiene `@@index([category])` en model Prompt
- [ ] Schema tiene `@@index([status])` en model Prompt
- [ ] Schema tiene `@@index([authorId])` en model Prompt
- [ ] `bun run db:push` aplica √≠ndices sin errores

## Definition of Done

### Tests
- [ ] `bun run db:push` completa sin errores

### Security
- N/A

### Observability
- N/A

### Docs
- [ ] Comentario en schema explicando cada √≠ndice

### Evidence
- [ ] Output de `bun run db:push`
- [ ] Diff del cambio

## Verify

### Commands
```bash
# Aplicar cambios
bun run db:push

# Verificar √≠ndices creados
sqlite3 prisma/dev.db ".indexes" | grep -E "Prompt_"
```

### Expected
- `db:push` completa exitosamente
- Output de `.indexes` muestra los nuevos √≠ndices

## Risk

### Failure Modes
- √çndices duplicados si ya existen impl√≠citamente
- Migraci√≥n falla en SQLite por limitaciones

### Rollback
```bash
git revert <commit-hash>
bun run db:push
```

## Notes
- SQLite crea √≠ndices impl√≠citamente para foreign keys
- Prisma puede crear √≠ndices con nombres autom√°ticos
- Verificar si ya existen antes de agregar

## Implementaci√≥n Sugerida

```prisma
// prisma/schema.prisma

model Prompt {
  id          String   @id @default(cuid())
  title       String
  description String
  body        String
  category    String
  // ... otros campos ...

  // √çndices para mejorar performance de queries frecuentes
  @@index([category])    // Filtro por categor√≠a
  @@index([status])      // Filtro por estado
  @@index([authorId])    // Filtro por autor
  @@index([category, status])  // Filtro combinado com√∫n
}
```

## Log de Cambios
| Fecha | Estado | Notas |
|-------|--------|-------|
| - | üî¥ Pending | Creado |
