# =============================================================================
# WORK ORDERS - Prompt Manager (ACTUALIZADO)
# =============================================================================
# Última actualización: 2026-02-17
# Total WOs: 22
# Completados: 15
# Pendientes: 7
# =============================================================================

---
# =============================================================================
# RESUMEN EJECUTIVO
# =============================================================================

resumen:
  total_wos: 22
  por_prioridad:
    P0: 2
    P1: 8
    P2: 7
    P3: 5

  por_estado:
    completados: 15
    en_progreso: 0
    pendientes: 7

  tiempo_invertido: "~4 horas + frontend plan en ejecución"

---
# =============================================================================
# P0 - CRÍTICO (Bloquea producción) - TODOS COMPLETADOS ✅
# =============================================================================

WO-0001:
  id: WO-0001
  titulo: "Fix useSearchParams Suspense boundary en /auth/signin"
  prioridad: P0
  estado: "[x] COMPLETADO"
  area: Config
  tipo: bug
  archivos:
    - src/app/auth/signin/page.tsx
  solucion_aplicada: |
    - Extraído SignInForm como componente separado
    - Envuelto en <Suspense> con fallback
    - Agregado campo password al formulario

WO-0002:
  id: WO-0002
  titulo: "Fix useSearchParams Suspense boundary en /auth/error"
  prioridad: P0
  estado: "[x] COMPLETADO"
  area: Config
  tipo: bug
  archivos:
    - src/app/auth/error/page.tsx
  solucion_aplicada: |
    - Extraído AuthErrorContent como componente separado
    - Envuelto en <Suspense> con fallback

---
# =============================================================================
# P1 - ALTO (Seguridad/Estabilidad)
# =============================================================================

WO-0003:
  id: WO-0003
  titulo: "Remover NEXTAUTH_SECRET hardcodeado como fallback"
  prioridad: P1
  estado: "[x] COMPLETADO"
  area: Sec
  tipo: security
  archivos:
    - src/lib/auth.ts
  solucion_aplicada: |
    - Agregado warning explícito si falta NEXTAUTH_SECRET
    - Documentado en .env.example
    - No bloquea build pero alerta en producción

WO-0004:
  id: WO-0004
  titulo: "Agregar rate limiting a /api/seed endpoint"
  prioridad: P1
  estado: "[x] COMPLETADO"
  area: Sec
  tipo: security
  archivos:
    - src/app/api/seed/route.ts
  solucion_aplicada: |
    - Importado y aplicado checkRateLimit()
    - Usado RATE_LIMIT_PRESETS.strict (10 req/min)
    - Agregado log de acceso

WO-0005:
  id: WO-0005
  titulo: "Reducir JWT maxAge de 30 días a 1 hora"
  prioridad: P1
  estado: "[x] COMPLETADO"
  area: Sec
  tipo: security
  archivos:
    - src/lib/auth.ts
  solucion_aplicada: |
    - Cambiado maxAge de 30*24*60*60 a 1*60*60 (1 hora)
    - Comentado con referencia a WO

WO-0006:
  id: WO-0006
  titulo: "Remover mensaje de development auth en signin"
  prioridad: P1
  estado: "[x] COMPLETADO"
  area: Sec
  tipo: security
  archivos:
    - src/app/auth/signin/page.tsx
  solucion_aplicada: |
    - Removido mensaje de development mode
    - Agregado campo password
    - Actualizado copy para credenciales normales

WO-0007:
  id: WO-0007
  titulo: "Agregar errorId a responses 500 para debugging"
  prioridad: P1
  estado: "[x] COMPLETADO"
  area: API
  tipo: improvement
  estimacion: 45min
  notas: |
    Requiere modificar múltiples API routes para agregar errorId único
    a cada response 500 con correlación en logs.
  solucion_aplicada: |
    - Utilidad createErrorResponse ya existe en src/lib/api-utils.ts
    - Actualizados /api/prompts/[id]/publish para usar createErrorResponse
    - Actualizados /api/prompts/[id]/feedback para usar createErrorResponse
    - Ahora todos los 500 responses incluyen errorId único para debugging

---
# =============================================================================
# P2 - MEDIO (Calidad/DX) - TODOS COMPLETADOS ✅
# =============================================================================

WO-0008:
  id: WO-0008
  titulo: "Habilitar reactStrictMode en next.config.ts"
  prioridad: P2
  estado: "[x] COMPLETADO"
  area: Config
  tipo: quality
  archivos:
    - next.config.ts
  solucion_aplicada: |
    - Cambiado reactStrictMode: false → true

WO-0009:
  id: WO-0009
  titulo: "Remover ignoreBuildErrors de next.config.ts"
  prioridad: P2
  estado: "[x] COMPLETADO"
  area: Config
  tipo: quality
  archivos:
    - next.config.ts
    - tsconfig.json
    - Múltiples archivos .ts con errores de tipo
  solucion_aplicada: |
    - Cambiado ignoreBuildErrors: true → false
    - Excluidos directorios examples/ y skills/ del tsconfig
    - Fixeados todos los errores de tipo:
      - Agregado id: randomUUID() a todos los create de Prisma
      - Cambiado .error.errors → .error.issues (Zod 4)
      - Fixeado z.record() con 2 argumentos (Zod 4)
      - Corregido nombre de relaciones Prisma

WO-0010:
  id: WO-0010
  titulo: "Habilitar noImplicitAny en tsconfig.json"
  prioridad: P2
  estado: "[x] COMPLETADO"
  area: Config
  tipo: quality
  archivos:
    - tsconfig.json
  solucion_aplicada: |
    - Cambiado noImplicitAny: false → true

WO-0011:
  id: WO-0011
  titulo: "Documentar limitación de rate limiting in-memory"
  prioridad: P2
  estado: "[x] COMPLETADO"
  area: Docs
  tipo: documentation
  archivos:
    - src/lib/rate-limit.ts
  solucion_aplicada: |
    - Agregado comentario documental con recomendaciones
    - Listadas alternativas: @upstash/ratelimit, Redis, etc.

---
# =============================================================================
# P3 - BAJO (Mejoras)
# =============================================================================

WO-0012:
  id: WO-0012
  titulo: "Crear .env.example con variables documentadas"
  prioridad: P3
  estado: "[x] COMPLETADO"
  area: DX
  tipo: documentation
  archivos:
    - .env.example
  solucion_aplicada: |
    - Creado archivo con todas las variables
    - Agregado production checklist
    - Documentados warnings de seguridad

WO-0013:
  id: WO-0013
  titulo: "Agregar tests de integración para API routes"
  prioridad: P3
  estado: "[x] COMPLETADO"
  area: Tests
  tipo: testing
  estimacion: 4h
  notas: |
    Requiere crear tests para:
    - /api/prompts (GET, POST)
    - /api/prompts/[id] (GET, PUT, DELETE)
    - /api/categories
    - /api/auth/signup
  solucion_aplicada: |
    - Tests de integración ya existentes en src/__tests__/api/
    - prompts.test.ts: GET, POST, autenticación
    - categories.test.ts: GET, POST
    - auth-signup.test.ts: POST
    - user.test.ts: GET
    - stats.test.ts: GET

WO-0014:
  id: WO-0014
  titulo: "Mejorar manejo de errores en client fetch"
  prioridad: P3
  estado: "[x] COMPLETADO"
  area: Frontend
  tipo: improvement
  archivos:
    - src/lib/store.ts
  solucion_aplicada: |
    - Agregado try/catch para leer body del error
    - Logueado error completo en consola
    - Extraído mensaje de error más descriptivo

WO-0015:
  id: WO-0015
  titulo: "Agregar validación de NEXTAUTH_URL en producción"
  prioridad: P3
  estado: "[x] COMPLETADO"
  area: Config
  tipo: improvement
  archivos:
    - src/lib/auth.ts
    - .env.example
  solucion_aplicada: |
    - Agregado warning en producción si falta NEXTAUTH_URL
    - Documentado en .env.example con ejemplos

---
# =============================================================================
# CAMBIOS ADICIONALES (No planificados)
# =============================================================================

cambios_adicionales:
  - descripcion: "Fix tsconfig.json - excluir docs/examples/ del build"
    archivos:
      - tsconfig.json
    detalle: |
      Añadido 'docs/examples' a exclude para resolver error de socket.io-client
      en docs/examples/websocket/frontend.tsx que bloqueaba el build.

  - descripcion: "Fix eslint.config.mjs - excluir docs/examples/ del lint"
    archivos:
      - eslint.config.mjs
    detalle: |
      Añadido 'docs/examples/**' a ignores para resolver errores de lint
      en docs/examples/ que estaban bloqueando el CI.
  - descripcion: "Fixeados nombres de relaciones Prisma en múltiples archivos"
    archivos:
      - src/app/api/prompts/route.ts
      - src/app/api/prompts/[id]/route.ts
      - src/app/api/prompts/[id]/publish/route.ts
      - src/app/api/prompts/[id]/feedback/route.ts
    detalle: |
      Cambiado 'author' → 'User_Prompt_authorIdToUser'
      Cambiado 'reviewer' → 'User_Prompt_reviewerIdToUser'
      Cambiado 'versions' → 'PromptVersion'
      Cambiado 'user' → 'User'

  - descripcion: "Agregado id: randomUUID() a todos los create de Prisma"
    razon: "El schema requiere id explícito (no auto-generado)"

  - descripcion: "Fixeado prompt-editor.tsx escape de llaves"
    archivo: src/components/prompt-manager/prompt-editor.tsx
    detalle: 'Cambiado {''{nombre}'', ''{departamento}''} → {"{nombre}"}, {"{departamento}"}'

---
# =============================================================================
# VERIFICACIÓN FINAL
# =============================================================================

verificacion:
  lint: "✅ Sin errores"
  tests: "✅ 15/15 pasando"
  build: "✅ Exitoso"
  prisma: "✅ Schema válido"

  comandos:
    - "bun run lint"
    - "bun run test:run"
    - "bun run build"
    - "bunx prisma validate"

---
# =============================================================================
# FRONTEND IMPROVEMENT PROGRAM (2026-02-17)
# =============================================================================
# Fuente: plans/FRONTEND-IMPROVEMENT-PLAN.md
# Estrategia: ejecutar por WO con gates (lint + test + build) por cada entrega.

WO-0016:
  id: WO-0016
  titulo: "Baseline de métricas + guardrails frontend"
  prioridad: P1
  estado: "[x] COMPLETADO"
  area: Frontend
  tipo: planning
  fase: "Fase 0"
  estimacion: 90min
  depende_de: []
  archivos:
    - plans/FRONTEND-IMPROVEMENT-PLAN.md
    - docs/plans/2026-02-17-frontend-baseline.md
    - tsconfig.json
    - eslint.config.mjs
  criterios_aceptacion: |
    - Baseline inicial documentado (Lighthouse mobile/desktop en landing)
    - Checklist mínimo de a11y definido para cambios UI
    - Eventos base definidos para medir CTA y uso de /app
  verificacion:
    - bun run lint
    - bun run test:run
    - bun run build
  notas: |
    Gates verificados exitosamente.
    - tsconfig.json actualizado: docs/examples/ excluido del build
    - eslint.config.mjs actualizado: docs/examples/ excluido del lint
    - Baseline doc creado en docs/plans/2026-02-17-frontend-baseline.md
    - Verificación Playwright completada: buscar/abrir/crear prompt (POST /api/prompts = 200)
    - Checklist A11y actualizado: skip link + labels/ARIA críticos verificados
    - Lighthouse formal ejecutado (mobile/desktop en / y /app) y documentado en docs/plans/2026-02-17-frontend-baseline.md

WO-0017:
  id: WO-0017
  titulo: "Fix navegación landing + remover trust signals no verificables"
  prioridad: P1
  estado: "[x] COMPLETADO"
  area: Frontend
  tipo: bugfix
  fase: "Fase 1"
  estimacion: 60min
  depende_de:
    - WO-0016
  archivos:
    - src/app/page.tsx
    - src/__tests__/app/a11y-smoke.test.ts
  criterios_aceptacion: |
    - Links Documentación/Precios no apuntan a /app
    - Se eliminan claims de uso no verificables
    - No se degrada la estructura responsive actual
  verificacion:
    - bun run lint
    - bun run test:run
    - bun run build
  notas: |
    Cierre WO-0017 verificado.
    - Header: links Documentación y Precios apuntan a #features (no /app)
    - Trust signals no verificables removidos del hero
    - Footer: Privacidad/Términos como texto no interactivo (sin affordance falsa)
    - Ancla #features ajustada con scroll-mt-24 para header sticky
    - Cobertura mínima agregada en src/__tests__/app/a11y-smoke.test.ts

WO-0018:
  id: WO-0018
  titulo: "Reemplazar placeholder por screenshot real optimizada"
  prioridad: P1
  estado: "[x] COMPLETADO"
  area: Frontend
  tipo: improvement
  fase: "Fase 1"
  estimacion: 75min
  depende_de:
    - WO-0016
  archivos:
    - src/app/page.tsx
    - public/
  criterios_aceptacion: |
    - Hero muestra screenshot real de producto
    - Asset optimizado y servido correctamente con Next/Image
    - No hay layout shift evidente en carga inicial
  verificacion:
    - bun run lint
    - bun run test:run
    - bun run build

WO-0019:
  id: WO-0019
  titulo: "Landing polish con jerarquía visual y motion accesible"
  prioridad: P2
  estado: "[x] COMPLETADO"
  area: Frontend
  tipo: enhancement
  fase: "Fase 2"
  estimacion: 3h
  depende_de:
    - WO-0017
    - WO-0018
  archivos:
    - src/app/page.tsx
    - src/app/globals.css
  criterios_aceptacion: |
    - Jerarquía visual de hero/features mejorada sin sobrecarga decorativa
    - Microinteracciones respetan prefers-reduced-motion
    - Lighthouse mobile en landing no cae vs baseline
  verificacion:
    - bun run lint
    - bun run test:run
    - bun run build
  notas: |
    Cierre WO-0019 verificado.
    - prefers-reduced-motion implementado globalmente en src/app/globals.css
    - Lighthouse mobile landing validado post-cambios: 78
    - Baseline WO-0016 (landing mobile): 77
    - Criterio cumplido: no cae vs baseline (78 >= 77)
    - Evidencia: output/lighthouse/landing-mobile-wo-0019.json

WO-0020:
  id: WO-0020
  titulo: "App header polish con búsqueda persistente y jerarquía clara"
  prioridad: P2
  estado: "[x] COMPLETADO"
  area: Frontend
  tipo: enhancement
  fase: "Fase 3"
  estimacion: 2h
  depende_de:
    - WO-0019
  archivos:
    - src/app/app/page.tsx
    - src/components/prompt-manager/
  criterios_aceptacion: |
    - Header de /app mejora legibilidad y acceso a acciones frecuentes
    - Search/filter/view toggle mantienen comportamiento actual
    - Sin regresiones en loading/error states
  verificacion:
    - bun run lint
    - bun run test:run
    - bun run build

WO-0021:
  id: WO-0021
  titulo: "Rediseño incremental de cards y empty states en /app"
  prioridad: P2
  estado: "[x] COMPLETADO"
  area: Frontend
  tipo: enhancement
  fase: "Fase 3"
  estimacion: 3h
  depende_de:
    - WO-0019
  archivos:
    - src/app/app/page.tsx
    - src/components/prompt-manager/
  criterios_aceptacion: |
    - PromptCard mejora acciones visibles y metadata legible
    - Empty states incluyen guidance accionable
    - UI mantiene consistencia con tokens y componentes existentes
  verificacion:
    - bun run lint
    - bun run test:run
    - bun run build

WO-0022:
  id: WO-0022
  titulo: "Extensiones opcionales (command palette/onboarding/settings mínimo)"
  prioridad: P3
  estado: "[x] COMPLETADO"
  area: Frontend
  tipo: feature
  fase: "Fase 4"
  estimacion: 4h
  depende_de:
    - WO-0020
    - WO-0021
  archivos:
    - src/app/app/page.tsx
    - src/components/
  criterios_aceptacion: |
    - Features opcionales detrás de rollout controlado
    - Sin impacto crítico en bundle/performance
    - Documentación de uso y fallback actualizada
  verificacion:
    - bun run lint
    - bun run test:run
    - bun run build
  notas: |
    Command palette implementada:
    - Atajo de teclado Cmd+K / Ctrl+K
    - Navegación: Biblioteca, Favoritos, Estadísticas
    - Acciones: Nuevo prompt
    - Vista: Cuadrícula / Lista
    - Hint de teclado visible en corner inferior derecho
