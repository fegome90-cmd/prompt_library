# WO-0008: Implementar paginaci贸n en GET /api/prompts

## Metadatos
| Campo | Valor |
|-------|-------|
| id | WO-0008 |
| title | Implementar paginaci贸n en GET /api/prompts |
| type | perf |
| priority | P2 |
| area | BE |
| status |  Pending |

## Rationale
Hallazgo PERF: Sin paginaci贸n, retorna todos los prompts. Con 30+ prompts es aceptable, pero no escala. Agregar paginaci贸n b谩sica.

## Scope

### Include
- `src/app/api/prompts/route.ts`
- `src/lib/store.ts` (fetchPrompts)

### Exclude
- No modificar otros endpoints
- No cambiar estructura de respuesta existente

## Dependencies
Ninguna

## Acceptance Criteria
- [ ] GET /api/prompts?page=1&limit=20 retorna primeros 20 prompts
- [ ] GET /api/prompts sin par谩metros retorna todos (backward compatible)
- [ ] Response incluye metadata: total, page, hasMore (cuando hay paginaci贸n)

## Definition of Done

### Tests
- [ ] curl con limit=5 retorna exactamente 5 prompts m谩ximo
- [ ] curl con page=2&limit=10 retorna prompts 11-20

### Security
- N/A

### Observability
- [ ] console.log con query params para debugging

### Docs
- [ ] Comentario en API explicando par谩metros

### Evidence
- [ ] curl commands mostrando paginaci贸n
- [ ] Diff del cambio

## Verify

### Commands
```bash
# Test paginaci贸n b谩sica
curl "http://localhost:3000/api/prompts?limit=5"

# Test segunda p谩gina
curl "http://localhost:3000/api/prompts?page=2&limit=10"

# Lint
bun run lint
```

### Expected
- Primer comando retorna array de 5 prompts m谩ximo
- Segundo comando retorna segunda p谩gina con metadata
- Lint pasa

## Risk

### Failure Modes
- Frontend espera array plano, ahora puede recibir objeto con metadata
- Clientes existentes se rompen

### Rollback
```bash
git revert <commit-hash>
```

## Notes
**DECISIN DE DISEO:**
- Mantener backward compatible
- Si no hay params: retorna array plano (comportamiento actual)
- Si hay params: retorna `{data: [], total, page, hasMore}`

## Implementaci贸n Sugerida

```typescript
// src/app/api/prompts/route.ts

export async function GET(request: NextRequest) {
  try {
    const { searchParams } = new URL(request.url);
    
    // Par谩metros de paginaci贸n
    const page = searchParams.get('page');
    const limit = searchParams.get('limit');
    
    // Filtros existentes
    const status = searchParams.get('status');
    const category = searchParams.get('category');
    const search = searchParams.get('search');
    const favorites = searchParams.get('favorites') === 'true';
    
    const where: Record<string, unknown> = {};
    // ... construcci贸n de where ...
    
    // Si hay paginaci贸n
    if (page || limit) {
      const pageNum = parseInt(page || '1');
      const limitNum = parseInt(limit || '20');
      const skip = (pageNum - 1) * limitNum;
      
      const [prompts, total] = await Promise.all([
        db.prompt.findMany({
          where,
          skip,
          take: limitNum,
          // ... resto de opciones
        }),
        db.prompt.count({ where }),
      ]);
      
      return NextResponse.json({
        data: prompts,
        total,
        page: pageNum,
        limit: limitNum,
        hasMore: skip + prompts.length < total,
      });
    }
    
    // Sin paginaci贸n - backward compatible
    const prompts = await db.prompt.findMany({ where, ... });
    return NextResponse.json(prompts);
  } catch (error) {
    // ...
  }
}
```

## Log de Cambios
| Fecha | Estado | Notas |
|-------|--------|-------|
| - |  Pending | Creado |
